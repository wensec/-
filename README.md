域名泛解析检测工具
简介
本工具用于检测目标域名是否配置了泛解析。泛解析是一种域名系统（DNS）配置，允许域名所有者为未明确配置的子域名自动分配 IP 地址。此工具通过生成随机子域名并分析其解析结果来判断是否存在泛解析配置。
功能特点
异步 DNS 查询，高效快速
自定义 DNS 服务器支持（默认使用公共 DNS）
彩色输出，结果清晰直观
详细的统计分析，包括 IP 分组和解析率计算
支持自定义并发数、超时时间和测试子域名数量
安装依赖
bash
pip install aiodns colorama
使用方法
bash
python script3.py example.com
可选参数:
plaintext
  -h, --help            显示此帮助信息并退出
  -t THREADS, --threads THREADS
                        并发线程数 (默认: 10)
  -T TIMEOUT, --timeout TIMEOUT
                        DNS查询超时时间 (秒, 默认: 5)
  -c COUNT, --count COUNT
                        随机子域名测试数量 (默认: 20)
  --system-dns          使用系统DNS服务器而非默认的公共DNS
输出说明
工具运行后会显示以下信息：

主域名的 A 记录解析结果
随机子域名的解析情况
解析率统计和泛解析判断结果
IP 地址分组统计（显示前 5 个最常见的 IP）
主域名 IP 与随机子域名 IP 的重叠情况分析
示例输出
plaintext
[+] 正在检测域名 example.com 是否配置泛解析...
[*] 查询主域名 A 记录...
[+] 主域名 A 记录: 93.184.216.34
[*] 生成 20 个随机子域名进行测试...
[1/20] z84l5n6c2d9x.example.com -> 93.184.216.34
[2/20] a1b2c3d4e5f6.example.com -> 93.184.216.34
... 中间省略 10 个结果 ...
[19/20] v9w8x7y6z5a4.example.com -> 93.184.216.34
[20/20] q2w3e4r5t6y7.example.com -> 93.184.216.34

[+] IP分组统计:
  93.184.216.34 出现 20 次 (100.0%)

[!] 高度确认存在泛解析 (100% 的随机子域名可解析)
[!] 主域名IP与随机子域名IP存在重叠: 93.184.216.34
[!] 这表明泛解析配置可能指向与主域名相同的服务器

[+] 检测完成，耗时 1.24 秒
[+] 使用的DNS服务器: 8.8.8.8, 1.1.1.1, 9.9.9.9, 208.67.222.222
技术原理
工具通过以下步骤判断域名是否配置了泛解析：

首先查询主域名的 A 记录
生成大量随机子域名（默认 20 个）
并发查询这些随机子域名的 A 记录
分析解析结果：
如果超过 90% 的随机子域名能够解析，则高度确认存在泛解析
如果超过 50% 的随机子域名能够解析，则可能存在泛解析
否则认为未检测到泛解析
对解析出的 IP 地址进行分组统计，分析其分布情况
比较主域名 IP 和随机子域名 IP 是否存在重叠
注意事项
由于网络环境和 DNS 缓存的影响，结果可能存在一定误差
大量并发查询可能会被某些 DNS 服务器限制或屏蔽
在使用公共 DNS 服务器时，结果反映的是公共网络中的泛解析配置
使用--system-dns参数可以测试本地网络环境中的泛解析配置
贡献
欢迎提交问题报告或代码贡献，帮助改进这个工具。
